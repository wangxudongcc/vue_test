<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" href="/public/css/reset.css">
    <link rel="stylesheet" href="/public/css/register.css">
    <style>
        h2{
            display:none;
        }
#info{
    display: none;
}
    
    </style>
</head>
<body>
    <h2 id="userInfo">欢迎回来<span id='user'></span></h2>
    <div class="form-wrapper">
        <div class="banner"> </div>
            <div class="item-wrapper">
                <label for="username">登陆名</label>
                <input type="text" name="username" id="username" value="wxd">
            </div>
            <div class="item-wrapper">
                <label for="password">密码</label>
                <input type="password" name="password" id="password" value="12345">
            </div>
<input type="button" value="登录" id="submit">
<input type="button" value="注册" id="register">      
<p id="info">请输入信息</p>
        </div>
        <script>
            register.onclick = function(){
                let v1= username.value;
                let p1 = password.value;

                fetch('api/user/register',{
                    method:'post',
                    body:''+new URLSearchParams({
                        username:v1,
                        password:p1
                    }),
                    headers:{
                        'content-type':'application/x-www-form-urlencoded'
                    }
                }).then(d=>d.json()).then(d=>{
                    if(d.code === 0){
                        alert('恭喜注册成功');
                        window.location.href = '/backup';
                    }else if(d.code ===1){
                        alert('用户名已经占用');

                    }   
                username.value = password.value =''; 
                })
            }
            submit.onclick = function(){
                let v1 = username.value;
                let p1 = password.value;

                fetch('/api/user/login',{
                    method:'post',
                    body:''+new URLSearchParams({
                        username:v1,
                        password:p1
                    }),
                    headers:{
                        'content-type':'application/x-www-form-urlencoded'
                    }
                }).then(d=>d.json()).then(d=>{
                    if(d.code ===-3){
                        alert(d.msg);
                    }else if(d.code ===0){
                        alert('欢迎'+d.userInfo.username+'回来');
                       
                       window.location.href = '/backup'; username.value = password.value = '';
                    }
                })
            }
        </script>

</body>
</html>