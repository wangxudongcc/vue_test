<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        // Q:这个方法显示不是弹框？而是一些判定
async showSubmitDlg(type) {
            if (type == 'submit') {
                let opinionType = this.$refs.ClaimOpinionEdit.opinionType;  //操作类型
                let damageDuringTwoDays = this.form.damageDuringTwoDays;    //
                let claimModifyFlag = this.form.claimModifyFlag;
                let backCurNode = this.form.curNode;
                if (backCurNode == '232' && claimModifyFlag == '1') {//二级立案修改页面
                    let chargeLossIndex = this.form.prpLclaimFeeList.length;
                    if (chargeLossIndex != undefined && chargeLossIndex != null) {
                        for (let i = 0; i < chargeLossIndex; i++) {
                            this.changeStateFuns.changeKindCodeDisabled(false, i);
                        }
                    }
                }
                if (opinionType != undefined
                    && opinionType != null && claimModifyFlag != '1') {
                    let claimLevelVar = this.form.claimLevel;
                    if (claimLevelVar != undefined
                        && claimLevelVar != null
                        && claimLevelVar == '1'
                        && opinionType == '001'
                        && damageDuringTwoDays != undefined
                        && damageDuringTwoDays != null
                        && damageDuringTwoDays == 'Y') {
                        await this.$alert("当前立案保单存在历史报案出险日期在本案出险日期前后两天内，请提交至二级立案处理！");
                        return false;
                    } else if (claimLevelVar != undefined
                        && claimLevelVar != null
                        && (claimLevelVar == '1'
                            || claimLevelVar == '2')
                        && opinionType == '002') {
                        let riskLevel = this.form.riskLevel || '';
                        let riskTypeCode = this.form.riskTypeCode || '';
                        let urgentLevel = this.form.urgentLevel || '';
                        let required = this.form.description;
                        if (riskLevel != undefined
                            && riskLevel != null
                            && riskTypeCode != undefined
                            && riskTypeCode != null
                            && urgentLevel != undefined
                            && urgentLevel != null
                            && required != null
                            && (riskLevel == null
                                || riskLevel.trim() == ""
                                || riskTypeCode == null
                                || riskTypeCode.trim() == ""
                                || urgentLevel == null
                                || required.trim() == ""
                                || urgentLevel.trim() == "")) {
                            await this.$alert("请录入【内控等级】、【案件类型】、【立案时效优先级】或【立案建议】！");
                            return false;
                        }
                    }
                }
                this.title = "立案任务提交";
            } else {
                this.title = "提示信息";
            }
            await instance.addClaim({
                userCodeSession: this.$store.getters.userInfo.userCode,
                comCodeSession: this.$store.getters.userInfo.comCode,
                ...this.form,
                saveType: type,
                opinionType: this.$refs.ClaimOpinionEdit.opinionType,
            }).then((res) => {
                this.submitForm = res.data;
            }).catch((error) => {
                this.$alert(error.messageKey ? error.messageKey : (error.statusText && error.statusText.message ? error.statusText.message : "暂存失败"), {
                    type: "error",
                    callback() {
                        this._pageReload();
                    }
                });
            });
            this.submitDlg = true;
        }
    </script>
</body>
</html>